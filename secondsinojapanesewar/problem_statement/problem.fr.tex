\problemname{}

\illustration{0.3}{map.jpg}{}

Notre histoire se passe pendant la seconde guerre sino-japonaise en 1937, qui opposa le Kuomintang et le Parti communiste chinois, alors en guerre civile depuis 10 ans, à l’empire du Japon. Cette guerre se déroula 6 ans après l’invasion de la Mandchourie par l’Armée impériale du Japon. Ce dernier, voulant poursuivre sa politique expansionniste en Chine, était optimiste quant à ses chances de terminer le conflit rapidement. Pour y parvenir, le 7 juillet 1937, l’incident du pont Marco Polo fournit au Japon un prétexte pour ouvrir les hostilités. L’empereur du Japon, Hirohito, donna son accord à l’invasion du reste du territoire chinois. Suite à cela, les forces chinoises unifiées subirent une série de désastres dans le nord du pays. L’état-major japonais décida également d’envahir la ville de Shanghai, située sur la côte est de la Chine, ville stratégique grâce à son accès à la mer et à son développement plus important que celui des autres villes chinoises, pour accélérer la fin du conflit. À partir du 23 août, les troupes amphibies japonaises commencèrent à débarquer massivement sur les côtes chinoises près de Shanghai.

C’est là que vous entrez en jeu : vous êtes un général chinois ayant obtenu ce poste grâce à vos liens avec des politiciens et des amis haut placés, une situation très récurrente dans les forces armées chinoises, en proie à la corruption et au népotisme.
Vous êtes à la tête d’un corps d’armée parti de Shanghai, qui est sous-entraîné et sous-armé, et qui a pour but de ralentir l’avancée japonaise avant qu’elle n’atteigne Shanghai, afin que les troupes qui s’y trouvent puissent terminer la défense de la ville.

Les Japonais disposent d’une plus grande puissance de feu, ainsi que d’un soutien naval et aérien important.
Votre stratégie repose sur le nombre d’hommes que vous avez, bien supérieur à celui des Japonais.
La région de Shanghai est composée de villes et de villages.

Votre stratégie repose sur un mouvement calculé : établir une ligne de défense dans une ville clé, attendre l’arrivée des Japonais, puis battre en retraite successivement à travers plusieurs villages et hameaux voisins, le tout pour revenir à la ville initiale à la fin du parcours. Il est important de ne jamais retourner deux fois au même endroit (à l'exception de la ville initiale), étant donné que ça donnerait un indice aux ennemis, ni de réemprunter en sens inverse un chemin déjà emprunté.
Cette stratégie va permettre de mettre en valeur l’avantage numérique de votre armée. Vous disposez pour cela d’une carte avec des villes et des villages situés entre la côte et la ville de Shanghai, avec des routes entre les villes qui peuvent être empruntées dans les deux directions. Certaines villes et villages sont marqués, indiquant qu’ils sont favorables à une contre-attaque pour votre stratégie et sont donc des candidats pour devenir la ville initiale. Il est important de noter que plus le nombre de villes et de villages à parcourir est élevé, plus vous allez perdre d’hommes lorsque vous allez battre en retraite.

En tant que général chinois, c'est donc à vous de trouver toutes les villes efficaces pour votre contre-attaque. À noter qu'il faut traverser au moins une ville autre que la ville candidate.

\begin{Input}
    L'entrée consiste en :
    \begin{itemize}
        \item Une ligne avec trois entiers $n, m, p$ ($1 \leq n, m\leq 301$) ($1 \leq p \leq \frac{n (n-1)}{2}$), le nombre de villes, le nombre de villes candidates et le nombre de chemins entre deux villes.
        \item Une ligne avec $m$ entiers $m_i$ ($0 \leq m < n$), les villes candidates.
        \item $p$ lignes avec deux entiers $u$, $v$ ($0 \leq u, v < n$), un chemin allant de la ville u à la ville v.
    \end{itemize}
    Il est garanti qu'une solution existe toujours.
\end{Input}

\begin{Output}
    \begin{itemize}
        \item Un nombre $n$, le nombre de villes efficaces pour la contre-attaque.
        \item $n$ nombres, les villes initiales qui correspondent au mieux à la stratégie.
    \end{itemize}
\end{Output}
